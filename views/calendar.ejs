<!DOCTYPE html>
<html>
<head>
    <title>Calendar</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>

    <img src="/logo.png" class="logo" alt="Logo">
    <h1>Appointment Calendar</h1>

    <table>
        <tr>
            <th>Patient</th>
            <th>Doctor</th>
            <th>Date & Time</th>
            <th>Action</th>
        </tr>

        <% if (appts.length === 0) { %>
            <tr><td colspan="4">No appointments scheduled</td></tr>
        <% } %>

        <% appts.forEach(a => { %>
        <tr>
            <td><%= a.patient %></td>
            <td><%= a.doctor %></td>

            <td>
                <% 
                    const d = new Date(a.datetime);

                    if (!isNaN(d)) {
                        const yyyy = d.getFullYear();
                        const mm = String(d.getMonth() + 1).padStart(2, "0");
                        const dd = String(d.getDate()).padStart(2, "0");

                        let hours = d.getHours();
                        const minutes = String(d.getMinutes()).padStart(2, "0");
                        const ampm = hours >= 12 ? "PM" : "AM";
                        hours = hours % 12;
                        hours = hours ? hours : 12;
                %>

                <%= `${yyyy}-${mm}-${dd} ${hours}:${minutes} ${ampm}` %>

                <% } else { %>
                    <%= a.datetime %>
                <% } %>
            </td>

            <td class="action-links">
                <a href="/edit/<%= a.id %>" class="edit">Edit</a>
                <a href="/delete/<%= a.id %>" class="delete">Delete</a>
            </td>
        </tr>
        <% }) %>
    </table>

    <a class="small-link" href="/">Back to Home</a>

</body>
</html>
